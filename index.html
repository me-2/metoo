<!-- <script src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="https://cdn.blockspring.com/blockspring.js"></script>

  <script type="text/javascript">
    
    $(document).ready(function () {
        var blockspring = require('blockspring');

        blockspring.define(function(request, response) {

        var query = "SELECT A";
  
        blockspring.runParsed("query-google-spreadsheet", { 
              "query": query,
              "url": "https://docs.google.com/spreadsheets/d/11JYfkdJu2DNf1FLdvd4tlkzRklE1_c4lsxS_peHpXkA/edit#gid=1504627451" 
            }, { cache: true, expiry: 7200}, function(res) {
  		      response.addOutput('cards', res.params.data);
            response.end();
	          });
	
        });
        
    });
      
  </script>

<body>
hey there
  
  <input type='text' id='idea' />
  <input type='button' value='add to list' id='add' />
  <ul id='list'></ul>

  <script>
    document.getElementById("add").onclick = function() {
    //First things first, we need our text:
    var text = document.getElementById("idea").value; //.value gets input values

    //Now construct a quick list element
    var li = "<li>" + text + "</li>";

    //Now use appendChild and add it to the list!
    var z = document.createElement('li');
    z.innerHTML = li;
    document.getElementById("list").appendChild(z);
    }
  </script>
  

</body>
 -->
<!DOCTYPE html> 
<html> 
	<head> 
    <title>Google Spreadsheet Javascript</title> 
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="google-spreadsheet.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">

    <style>
      body{
        background-color: #fff4cc;
        color: #6d6d6d;
        font-size: .8em;
        font-family: sans-serif;
      }
      h1,a{ color: #5491b2}
      input{
        font-size: .8em;
        background-color: white;
        color:#606568;
      }
    </style>
  </head> 
  <body > 

    <h1 id="title">me too</h1>

    <form id="foo">
        This is your story. 
        <p></p>
<!--          <label for="name">Comment:</label>
 -->        <textarea id="comment" name="comment" cols="40"></textarea>

        <input id="sendbuttn" type="submit" value="Send" />
    </form>

<!--     <pre id='results'></pre>
 -->
    <ul id='list'></ul>

    <div id='links'>

    <div id="main"></div>

    </div>



    <script>
    jQuery(document).ready(function($) {
       // Variable to hold request
        var request;

        // Bind to the submit event of our form
        $("#foo").submit(function(event){

            // Prevent default posting of form - put here to work in case of errors
            event.preventDefault();

            // Abort any pending request
            if (request) {
                request.abort();
            }
            // setup some local variables
            var $form = $(this);

            // Let's select and cache all the fields
            var $inputs = $form.find("input, select, button, textarea");

            // Serialize the data in the form
            var serializedData = $form.serialize();

            // Let's disable the inputs for the duration of the Ajax request.
            // Note: we disable elements AFTER the form data has been serialized.
            // Disabled form elements will not be serialized.
            $inputs.prop("disabled", true);

            // fire off the request to /form.php
            request = $.ajax({
                url: "https://script.google.com/macros/s/AKfycbyI4X8Oh8_cxQeIHMBUJOuvcyAOVTrY2mNWaJ_QW43L0DksDSo/exec",
                type: "post",
                data: serializedData
            });

            // Callback handler that will be called on success
            request.done(function (response, textStatus, jqXHR){
                // Log a message to the console
                console.log("Hooray, it worked!");
            });

            // Callback handler that will be called on failure
            request.fail(function (jqXHR, textStatus, errorThrown){
                // Log the error to the console
                console.error(
                    "The following error occurred: "+
                    textStatus, errorThrown
                );
            });

            // Callback handler that will be called regardless
            // if the request failed or succeeded
            request.always(function () {
                // Reenable the inputs
                $inputs.prop("disabled", false);
            });

        });
      });

   
    </script>


  <script>
  //   document.getElementById("add").onclick = function() {
  //   //First things first, we need our text:
  //   var text = document.getElementById("idea").value; //.value gets input values

  //   //Now construct a quick list element
  //   var li = "<li>" + text + "</li>";

  //   //Now use appendChild and add it to the list!
  //   var z = document.createElement('li');
  //   z.innerHTML = li;
  //   document.getElementById("list").appendChild(z);
  //   }
  // </script>
  


    <script id='script'>
      localStorage.clear();
      var sample_url = "https://docs.google.com/spreadsheets/d/168xHj4F6vkIU5Bvrot6Hq4goQlYiV8qylLkN1H9-G-I/edit?usp=sharing";//"https://spreadsheets.google.com/pub?key=0Ago31JQPZxZrdHF2bWNjcTJFLXJ6UUM5SldEakdEaXc&hl=en&output=html";
      var url_parameter = document.location.search.split(/\?url=/)[1]
      var url = url_parameter || sample_url;
      var googleSpreadsheet = new GoogleSpreadsheet();
      googleSpreadsheet.url(url);
      googleSpreadsheet.load(function(result) {
// 	 console.log(result.get("rows"));
        // console.log(JSON.stringify(result));
        var thJ = JSON.parse(JSON.stringify(result));   
        // console.log(JSON.stringify(thJ.data));

        var data = thJ.data;
        var col0 = [];
        var col1 = []
        // console.log(data);
        for(index=0; index<thJ.data.length; index++){
          if(index%2 == 0 && index!=0){
                // console.log(data[index]);
                col0.push(data[index]);

          } else if(index%2 == 1 && index!=1 && index!=0){
                col1.push(data[index]);
          }
        }
        // console.log(col0);
        // console.log(col1);

        for(comments=0; comments<col1.length;comments++){
            var div = document.createElement("div");
            var myheader = document.createElement("HEADER");
            myheader.innerHTML = col0[comments];
            div.style.width = "100%";
            div.style.height = "150px";
            div.style.background = "red";
            div.style.color = "white";
            myheader.style.marginTop = "20px";
            div.innerHTML = col1[comments];

            document.getElementById("main").appendChild(myheader);
            document.getElementById("main").appendChild(div);

        }


        // $('#results').html(JSON.stringify(result).replace(/,/g,",\n"));
        $('#results').html(JSON.stringify(thJ.data));
      });
    </script>

    <script>
      $('#code').html($('#script').html())
      $('#spreadsheet_url').html("<a href='"+url+"'>"+url+"</a>");
      $('#iframe').attr("src",url);
      $('input[name]').val(url);
      if (url != sample_url){
        $("div#links").append("<br/><a href='"+document.location.pathname+"'>Original Sample Spreadsheet</a>")
      }
    </script>

  </body>
</html>
